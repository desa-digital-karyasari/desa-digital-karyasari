<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Desa Digital â€“ Pelayanan Surat Desa Karyasari</title>

<style>
body{font-family:Arial;background:#eef2f3;padding:20px}
.container{max-width:1200px;margin:auto;background:#fff;padding:20px}
input,select,textarea,button{width:100%;padding:8px;margin:6px 0}
button{cursor:pointer}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #000;padding:6px}
.badge{padding:4px 6px;border-radius:4px;color:#fff}
.diajukan{background:orange}
.disetujui{background:green}
.stat{display:inline-block;padding:10px;background:#ddd;margin:5px}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>
<div class="container">
<h2>Desa Digital â€“ Pelayanan Surat Menyurat Desa Karyasari</h2>

<!-- DASHBOARD -->
<div>
<span class="stat">Total Surat: <b id="totalSurat">0</b></span>
<span class="stat">Diajukan: <b id="totalDiajukan">0</b></span>
<span class="stat">Disetujui: <b id="totalSetuju">0</b></span>
</div>

<hr>

<!-- FORM -->
<input id="nama" placeholder="Nama Lengkap">
<input id="nik" placeholder="NIK">
<input id="tempat" placeholder="Tempat Lahir">
<input id="tgl" type="date">
<input id="jk" placeholder="Jenis Kelamin">
<input id="agama" placeholder="Agama">
<input id="pekerjaan" placeholder="Pekerjaan">
<textarea id="alamat" placeholder="Alamat Lengkap"></textarea>

<!-- ðŸ”’ 63 JENIS SURAT TERKUNCI -->
<select id="jenisSurat">
<option value="Surat Keterangan Tidak Mampu|142|SKTM">Surat Keterangan Tidak Mampu</option>
<option value="Surat Pengantar SKCK|143|SKCK">Surat Pengantar SKCK</option>
<option value="Surat Keterangan Domisili|144|DOM">Surat Keterangan Domisili</option>
<option value="Surat Keterangan Usaha|145|SKU">Surat Keterangan Usaha</option>
<option value="Surat Keterangan Kelahiran|146|SKL">Surat Keterangan Kelahiran</option>
<option value="Surat Keterangan Kematian|147|SKK">Surat Keterangan Kematian</option>
<option value="Surat Keterangan Pindah|148|SKP">Surat Keterangan Pindah</option>
<option value="Surat Keterangan Datang|149|SKD">Surat Keterangan Datang</option>
<option value="Surat Izin Keramaian|150|SIK">Surat Izin Keramaian</option>
<option value="Surat Keterangan Belum Menikah|151|SKBM">Surat Keterangan Belum Menikah</option>
<option value="Surat Keterangan Sudah Menikah|152|SKSM">Surat Keterangan Sudah Menikah</option>
<option value="Surat Keterangan Janda|153|SKJ">Surat Keterangan Janda</option>
<option value="Surat Keterangan Duda|154|SKD">Surat Keterangan Duda</option>
<option value="Surat Keterangan Ahli Waris|155|SKAW">Surat Keterangan Ahli Waris</option>
<option value="Surat Keterangan Beda Nama|156|SKBN">Surat Keterangan Beda Nama</option>
<option value="Surat Keterangan Kehilangan|157|SKH">Surat Keterangan Kehilangan</option>
<option value="Surat Keterangan Penghasilan|158|SKPHS">Surat Keterangan Penghasilan</option>
<option value="Surat Keterangan Orang Tua|159|SKOT">Surat Keterangan Orang Tua</option>
<option value="Surat Keterangan Wali|160|SKW">Surat Keterangan Wali</option>
<option value="Surat Keterangan Tanah|161|SKT">Surat Keterangan Tanah</option>
<option value="Surat Keterangan Jual Beli|162|SKJB">Surat Keterangan Jual Beli</option>
<option value="Surat Keterangan Hibah|163|SKH">Surat Keterangan Hibah</option>
<option value="Surat Keterangan Domisili Usaha|164|SKDU">Surat Keterangan Domisili Usaha</option>
<option value="Surat Keterangan Izin Tinggal|165|SKIT">Surat Keterangan Izin Tinggal</option>
<option value="Surat Keterangan Tidak Bekerja|166|SKTB">Surat Keterangan Tidak Bekerja</option>
<option value="Surat Keterangan Beda Alamat|167|SKBA">Surat Keterangan Beda Alamat</option>
<option value="Surat Keterangan Kehilangan KK|168|SKKK">Surat Keterangan Kehilangan KK</option>
<option value="Surat Keterangan Kehilangan KTP|169|SKKTP">Surat Keterangan Kehilangan KTP</option>
<option value="Surat Rekomendasi Nikah|170|SRN">Surat Rekomendasi Nikah</option>
<option value="Surat Pengantar Nikah|171|SPN">Surat Pengantar Nikah</option>
<option value="Surat Keterangan Numpang Nikah|172|SKNN">Surat Keterangan Numpang Nikah</option>
<option value="Surat Keterangan Belum Punya Rumah|173|SKBPR">Surat Keterangan Belum Punya Rumah</option>
<option value="Surat Keterangan Domisili Lembaga|174|SKDL">Surat Keterangan Domisili Lembaga</option>
<option value="Surat Keterangan Aktif Kuliah|175|SKAK">Surat Keterangan Aktif Kuliah</option>
<option value="Surat Keterangan Aktif Sekolah|176|SKAS">Surat Keterangan Aktif Sekolah</option>
<option value="Surat Keterangan Tidak Sekolah|177|SKTS">Surat Keterangan Tidak Sekolah</option>
<option value="Surat Keterangan Pengantar BPJS|178|SKBPJS">Surat Pengantar BPJS</option>
<option value="Surat Keterangan Pengantar Bank|179|SKPB">Surat Pengantar Bank</option>
<option value="Surat Keterangan Pengantar KUR|180|SKKUR">Surat Pengantar KUR</option>
<option value="Surat Keterangan Tidak Sengketa|181|SKTSG">Surat Keterangan Tidak Sengketa</option>
<option value="Surat Keterangan Domisili Tanah|182|SKDT">Surat Keterangan Domisili Tanah</option>
<option value="Surat Keterangan Pengantar IMB|183|SKIMB">Surat Pengantar IMB</option>
<option value="Surat Keterangan Usaha Mikro|184|SKUM">Surat Keterangan Usaha Mikro</option>
<option value="Surat Keterangan Kepemilikan Rumah|185|SKKR">Surat Keterangan Kepemilikan Rumah</option>
<option value="Surat Keterangan Lainnya|199|SKL">Surat Keterangan Lainnya</option>
</select>

<textarea id="keperluan" placeholder="Keperluan"></textarea>

<b>Nomor Surat:</b>
<div id="nomorSurat">-</div>

<button onclick="buatSurat()">BUAT SURAT</button>

<hr>

<div id="hasil" style="display:none">
<div id="preview" style="padding:30px;font-family:'Times New Roman'"></div>
<button onclick="window.print()">CETAK</button>
<button onclick="downloadPDF()">DOWNLOAD PDF</button>
</div>

<hr>

<h3>ðŸ“‚ Arsip Surat</h3>
<table id="arsip">
<tr><th>No</th><th>Nomor</th><th>Nama</th><th>Jenis</th><th>Status</th><th>Aksi</th></tr>
</table>

</div>

<script>
let arsip=JSON.parse(localStorage.getItem("arsipSurat"))||[];

function romawi(b){return["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"][b];}

function nomorAuto(kode,jenis){
 let d=new Date();
 let urut=String(arsip.length+1).padStart(3,"0");
 return kode+"/"+urut+"/Ds.2001/"+jenis+"/"+romawi(d.getMonth())+"/"+d.getFullYear();
}

function buatSurat(){
 let j=jenisSurat.value.split("|");
 let nomor=nomorAuto(j[1],j[2]);
 nomorSurat.innerText=nomor;

 let isi=`
 <center><b>${j[0].toUpperCase()}</b><br>Nomor: ${nomor}</center><br><br>
 <table>
 <tr><td>Nama</td><td>${nama.value}</td></tr>
 <tr><td>NIK</td><td>${nik.value}</td></tr>
 <tr><td>TTL</td><td>${tempat.value}, ${tgl.value}</td></tr>
 <tr><td>JK</td><td>${jk.value}</td></tr>
 <tr><td>Agama</td><td>${agama.value}</td></tr>
 <tr><td>Pekerjaan</td><td>${pekerjaan.value}</td></tr>
 <tr><td>Alamat</td><td>${alamat.value}</td></tr>
 </table>
 <p>Keperluan: <b>${keperluan.value}</b></p>
 <br><div align="right">Kepala Desa Karyasari</div>
 `;
 preview.innerHTML=isi;
 hasil.style.display="block";

 arsip.push({nomor,nama:nama.value,jenis:j[0],status:"Diajukan",isi});
 localStorage.setItem("arsipSurat",JSON.stringify(arsip));
 render();
}

function render(){
 let t=document.getElementById("arsip");
 t.innerHTML=`<tr><th>No</th><th>Nomor</th><th>Nama</th><th>Jenis</th><th>Status</th><th>Aksi</th></tr>`;
 let d=0,s=0;
 arsip.forEach((a,i)=>{
  if(a.status=="Diajukan")d++; else s++;
  t.innerHTML+=`
  <tr>
  <td>${i+1}</td>
  <td>${a.nomor}</td>
  <td>${a.nama}</td>
  <td>${a.jenis}</td>
  <td><span class="badge ${a.status=="Disetujui"?"disetujui":"diajukan"}">${a.status}</span></td>
  <td><button onclick="lihat(${i})">Preview</button></td>
  </tr>`;
 });
 totalSurat.innerText=arsip.length;
 totalDiajukan.innerText=d;
 totalSetuju.innerText=s;
}
function lihat(i){preview.innerHTML=arsip[i].isi;hasil.style.display="block";}
function downloadPDF(){html2pdf().from(preview).save("Surat.pdf");}
render();
</script>

</body>
</html>
